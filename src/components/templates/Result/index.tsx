import { css } from '@emotion/react';
import Report from '../Report';
import { useEffect, useRef, useState } from 'react';
import { useResetProjection } from 'framer-motion';
import { ShareNative, ShareTwitter, ShareKakao } from '@/components/atom';
import { useRouter } from 'next/router';
import axios from 'axios';
import { toast } from 'react-toastify';
import { ArticleListDTO, getArticleDetail } from '@/api/article';
import { apiInstance } from '@/api';

export default function Result() {
  const router = useRouter();

  const [dto, setDto] = useState<ArticleListDTO>();
  // const dto = router.query.dto && JSON.parse(router.query.dto as string);
  const [isLike, setLike] = useState(false);

  useEffect(() => {
    if (!router.isReady) return;
    if (typeof router.query.id !== 'string') return;

    const articleId: number = parseInt(router.query.id);

    if (!articleId) return;

    getArticleDetail(articleId).then((data) => setDto(data));
  }, [router]);

  const style = {
    container: css`
      display: flex;
      flex-direction: column;
      align-items: center;
    `,
  };

  return (
    <div css={style.container}>
      <Report dto={dto} />
      <button
        type="button"
        css={css`
          margin-top: 36px;
        `}
        onClick={async () => {
          try {
            //            await axios.post(`${process.env.NEXT_PUBLIC_API_BASE_URL}/like/${articleId}`);
            setLike(!isLike);
            if (isLike) {
              toast.success('좋아요를 눌렀어요.');
            } else {
              toast.success('좋아요를 해제했어요.');
            }
          } catch (e) {
            console.log(e);
          }
        }}
      >
        <svg
          width="100"
          height="100"
          viewBox="0 0 100 100"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <rect width="100" height="100" fill="#1D1D1D" />
          <path
            d="M33.54 83.448C33.54 83.2147 33.6007 83 33.722 82.804C33.8433 82.608 34.0813 82.44 34.436 82.3C34.7907 82.16 35.2853 82.0527 35.92 81.978C36.564 81.894 37.404 81.852 38.44 81.852C39.4667 81.852 40.2973 81.894 40.932 81.978C41.576 82.0527 42.0753 82.16 42.43 82.3C42.7847 82.44 43.0227 82.608 43.144 82.804C43.2653 83 43.326 83.2147 43.326 83.448C43.326 83.6907 43.2653 83.91 43.144 84.106C43.0227 84.302 42.7847 84.47 42.43 84.61C42.0753 84.75 41.576 84.8573 40.932 84.932C40.2973 85.0067 39.4667 85.044 38.44 85.044C37.404 85.044 36.564 85.0067 35.92 84.932C35.2853 84.8573 34.7907 84.75 34.436 84.61C34.0813 84.47 33.8433 84.302 33.722 84.106C33.6007 83.91 33.54 83.6907 33.54 83.448ZM33.288 76.252C34.184 76.14 34.9167 76.014 35.486 75.874C36.0647 75.7247 36.5173 75.566 36.844 75.398C37.1707 75.23 37.3947 75.048 37.516 74.852C37.6467 74.656 37.7167 74.446 37.726 74.222H33.624V73.074H43.242V74.222H39.126C39.126 74.3527 39.1167 74.474 39.098 74.586C39.0793 74.698 39.0513 74.81 39.014 74.922L43.494 76.364L43.018 77.358L38.398 75.846C38.006 76.2007 37.4367 76.4993 36.69 76.742C35.9527 76.9753 34.9913 77.1807 33.806 77.358L33.288 76.252ZM32.798 77.974H37.726V76.854H39.126V77.974H44.068V79.122H32.798V77.974ZM43.662 81.32H33.204V80.172H37.726V79.5H39.126V80.172H43.662V81.32ZM35.22 83.448C35.22 83.5507 35.262 83.63 35.346 83.686C35.43 83.742 35.5887 83.784 35.822 83.812C36.0553 83.8493 36.382 83.8727 36.802 83.882C37.222 83.8913 37.768 83.896 38.44 83.896C39.1027 83.896 39.644 83.8913 40.064 83.882C40.484 83.8727 40.8107 83.8493 41.044 83.812C41.2773 83.784 41.436 83.7373 41.52 83.672C41.604 83.616 41.646 83.5413 41.646 83.448C41.646 83.3547 41.604 83.2753 41.52 83.21C41.436 83.154 41.2773 83.1073 41.044 83.07C40.8107 83.042 40.484 83.0233 40.064 83.014C39.644 83.0047 39.1027 83 38.44 83C37.768 83 37.222 83.0047 36.802 83.014C36.382 83.0233 36.0553 83.042 35.822 83.07C35.5887 83.1073 35.43 83.154 35.346 83.21C35.262 83.2753 35.22 83.3547 35.22 83.448ZM52.9989 78.772C52.9989 79.78 52.8916 80.648 52.6769 81.376C52.4716 82.0947 52.1916 82.6827 51.8369 83.14C51.4916 83.6067 51.0902 83.9473 50.6329 84.162C50.1756 84.3767 49.7042 84.484 49.2189 84.484C48.7149 84.484 48.2342 84.3767 47.7769 84.162C47.3289 83.9473 46.9276 83.6067 46.5729 83.14C46.2276 82.6827 45.9522 82.0947 45.7469 81.376C45.5416 80.648 45.4389 79.78 45.4389 78.772C45.4389 77.764 45.5416 76.9007 45.7469 76.182C45.9522 75.4633 46.2276 74.8753 46.5729 74.418C46.9276 73.9513 47.3289 73.6107 47.7769 73.396C48.2342 73.172 48.7149 73.06 49.2189 73.06C49.7042 73.06 50.1756 73.172 50.6329 73.396C51.0902 73.6107 51.4916 73.9513 51.8369 74.418C52.1916 74.8753 52.4716 75.4633 52.6769 76.182C52.8916 76.9007 52.9989 77.764 52.9989 78.772ZM46.8389 78.772C46.8389 79.6213 46.8996 80.34 47.0209 80.928C47.1516 81.5067 47.3242 81.9733 47.5389 82.328C47.7536 82.6827 48.0056 82.9393 48.2949 83.098C48.5842 83.2567 48.8922 83.336 49.2189 83.336C49.5362 83.336 49.8396 83.2567 50.1289 83.098C50.4182 82.9487 50.6702 82.6967 50.8849 82.342C51.0996 81.978 51.2676 81.5067 51.3889 80.928C51.5196 80.34 51.5849 79.6167 51.5849 78.758C51.5849 77.9087 51.5196 77.1947 51.3889 76.616C51.2676 76.0373 51.0996 75.5707 50.8849 75.216C50.6702 74.8613 50.4182 74.6047 50.1289 74.446C49.8396 74.2873 49.5362 74.208 49.2189 74.208C48.8922 74.208 48.5842 74.2873 48.2949 74.446C48.0056 74.6047 47.7536 74.8613 47.5389 75.216C47.3242 75.5707 47.1516 76.042 47.0209 76.63C46.8996 77.2087 46.8389 77.9227 46.8389 78.772ZM56.1069 77.512H57.7449V78.66H56.1069V84.484H54.7069V72.92H56.1069V77.512ZM58.8429 83.336H61.1109V80.158C60.5509 79.8033 60.1216 79.36 59.8229 78.828C59.5336 78.2867 59.3889 77.6893 59.3889 77.036C59.3889 76.4573 59.5056 75.9253 59.7389 75.44C59.9816 74.9547 60.3223 74.5347 60.7609 74.18C61.1996 73.8253 61.7316 73.55 62.3569 73.354C62.9823 73.1487 63.6869 73.046 64.4709 73.046C65.2176 73.046 65.9036 73.1487 66.5289 73.354C67.1543 73.55 67.6909 73.8253 68.1389 74.18C68.5869 74.5347 68.9369 74.9547 69.1889 75.44C69.4409 75.9253 69.5669 76.4573 69.5669 77.036C69.5669 77.6893 69.4176 78.2867 69.1189 78.828C68.8203 79.36 68.3909 79.8033 67.8309 80.158V83.336H70.1129V84.484H58.8429V83.336ZM64.4709 79.878C65.0683 79.878 65.5956 79.8033 66.0529 79.654C66.5103 79.4953 66.8929 79.29 67.2009 79.038C67.5183 78.7767 67.7563 78.4733 67.9149 78.128C68.0829 77.7827 68.1669 77.4187 68.1669 77.036C68.1669 76.6533 68.0829 76.2893 67.9149 75.944C67.7563 75.5987 67.5183 75.3 67.2009 75.048C66.8929 74.7867 66.5103 74.5813 66.0529 74.432C65.5956 74.2733 65.0683 74.194 64.4709 74.194C63.8736 74.194 63.3463 74.2733 62.8889 74.432C62.4316 74.5813 62.0443 74.7867 61.7269 75.048C61.4189 75.3 61.1856 75.5987 61.0269 75.944C60.8683 76.2893 60.7889 76.6533 60.7889 77.036C60.7889 77.4187 60.8683 77.7827 61.0269 78.128C61.1856 78.4733 61.4189 78.7767 61.7269 79.038C62.0443 79.29 62.4316 79.4953 62.8889 79.654C63.3463 79.8033 63.8736 79.878 64.4709 79.878ZM64.4709 81.026C63.7336 81.026 63.0803 80.942 62.5109 80.774V83.336H66.4309V80.774C65.8429 80.942 65.1896 81.026 64.4709 81.026Z"
            fill="white"
          />
          <path
            d="M50 33.6667L36.5 20L23 33.6667L50 61L77 33.6667L63.5 20L50 33.6667Z"
            fill={isLike ? 'red' : '#6E6E6E'}
          />
        </svg>
      </button>
      <div
        css={css`
          margin-top: 36px;
          padding-bottom: 50px;
        `}
      >
        <div
          css={css`
            margin-bottom: 8px;
            font-size: 14px;
            line-height: 140%;
            text-align: center;
          `}
        >
          친구에게 공유하기
        </div>
        <div
          css={css`
            padding-bottom: 50px;
            display: flex;
            gap: 26px;
            align-items: center;
          `}
        >
          <ShareKakao />
          <ShareNative />
          <button type="button" aria-label="홈으로 이동" onClick={() => router.push('/')}>
            <svg
              css={css`
                vertical-align: bottom;
              `}
              width="60"
              height="60"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M3 9.91667L11.9997 2L21 9.91667V12.2917L21 21L3.00017 21L3.00017 12.2917L3 9.91667Z"
                stroke="black"
                stroke-width="2"
              />
              <path d="M9 21L9 12H15V21" stroke="black" stroke-width="2" />
            </svg>
          </button>
        </div>
      </div>
    </div>
  );
}
